/**
 * Areas
 */

$use-areas: true !default;
$use-areas-gap: true !default;
$use-areas-vgap: true !default;

$areas-gap: $columns-gutter !default;
$areas-templates: () !default;

$areas-gap-sizes: () !default;
$areas-vgap-sizes: $grid-gap-sizes !default;


@function getAreaNames($areas) {
  $list: ();
  @each $area in $areas {
    $areaNames: split(' ', $area);
    @each $areaName in $areaNames {
      @if notInList($areaName, $list) {
        $list: join($list, $areaName);
      }
    }
  }
  @return $list;
}
@function getAreaColumnNumber($areas) {
  @each $area in $areas {
    $areaNames: split(' ', $area);
    @return length($areaNames);
  }
}
@function areKeysBreakpoints($grid-template-areas){
  $map-keys: map-keys($grid-template-areas);
  @each $key in $map-keys {
    @if inList($key, $breakpoints-classes) {
      @return true;
    }
  }
  @return false;
}

@mixin makeGridTemplate($grid-template-areas) {
  grid-template-areas: $grid-template-areas;
  grid-template-columns: repeat(getAreaColumnNumber($grid-template-areas), 1fr);
}
@mixin makeGridArea($areaNames) {
  @each $area in $areaNames {
    [#{$loop-component-prefix}-area~="#{$area}"] {
      grid-area: #{$area};
    }
  }
}
@mixin makeGrid($grid-template-areas) {
  @include makeGridTemplate($grid-template-areas);
  @include makeGridArea(getAreaNames($grid-template-areas));
}
@mixin makeGridOnBreakpoints($grid-template-areas) {
  $area-names-list: ();
  @each $breakpoint, $areas in $grid-template-areas {
    $area-names-list: getAreaNames(join($area-names-list, getAreaNames($areas)));
    @include breakpoint($breakpoint) {
      @include makeGridTemplate($areas);
    }
  }
  @include makeGridArea($area-names-list);
}

@if $use-areas and isNotEmpty($areas-templates) {

  [#{$loop-component-prefix}-areas] {
    display: grid;
    grid-gap: $grid-gap;
  }

  @if isList($areas-templates) {
    [#{$loop-component-prefix}-areas] {
      @include makeGrid($areas-templates);
    }
  } @else if isMap($areas-templates) {
    @if areKeysBreakpoints($areas-templates) {
      [#{$loop-component-prefix}-areas] {
        @include makeGridOnBreakpoints($areas-templates);
      }
    } @else {
      @each $area-name, $area-template in $areas-templates {
        [#{$loop-component-prefix}-areas~="#{$area-name}"] {
          @if isMap($area-template) {
            @include makeGridOnBreakpoints($area-template);
          } @else if isList($area-template) {
            @include makeGrid($area-template);
          }
        }
      }
    }
  }
}

@if $use-areas-gap {
  @each $gap-name, $gap-size in $areas-gap-sizes {
    [#{$loop-component-prefix}-areas~="gap-#{$gap-name}"] { grid-gap: $gap-size; }
  }
}
@if $use-areas-gap and $use-areas-vgap {
  @each $gap-name, $gap-size in $areas-vgap-sizes {
    [#{$loop-component-prefix}-areas~="vgap-#{$gap-name}"] { grid-row-gap: $gap-size; }
  }
}
